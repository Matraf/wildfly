<?xml version="1.0" encoding="UTF-8"?>
<feature-group-spec name="standalone-bdew"
                    xmlns="urn:jboss:galleon:feature-group:1.0">

    <origin name="org.wildfly:wildfly-ee-galleon-pack">
        <feature-group name="standalone-full"/>
    </origin>

    <feature spec="subsystem.elytron.dir-context">
        <param name="dir-context" value="WccLdapDirContext"/>
        <param name="url" value="${ldap.address:ldap://localhost:1234}"/>
        <param name="principal" value="${ldap.search.dn:uid=jobtest1,ou=People,dc=ee,dc=psi}"/>
        <param name="credential-reference" value="{clear-text=${ldap.search.credential:start123}}"/>
    </feature>

    <feature spec="subsystem.elytron.ldap-realm">
        <param name="ldap-realm" value="WccLdapRealm"/>
        <param name="dir-context" value="WccLdapDirContext"/>
        <param name="identity-mapping" value="{search-base-dn=${ldap.search.credential:start123},rdn-identifier=uid,user-password-mapper={from=&quot;userPassword&quot;},attribute-mapping=[{filter-base-dn=&quot;ou=Roles,dc=wildfly,dc=org&quot;,filter=&quot;(&amp;(objectClass=groupOfNames)(member={0}))&quot;,from=&quot;cn&quot;,to=&quot;Roles&quot;}]}"/>
    </feature>

    <feature spec="subsystem.elytron.simple-role-decoder">
        <param name="simple-role-decoder" value="from-roles-attribute"/>
        <param name="attribute" value="Roles"/>
    </feature>

    <feature spec="subsystem.elytron.security-domain">
        <param name="security-domain" value="WccLdapSecurityDomain"/>
        <param name="realms" value="[{realm=WccLdapRealm,role-decoder=from-roles-attribute}]"/>
        <param name="default-realm" value="WccLdapRealm"/>
        <param name="permission-mapper" value="default-permission-mapper"/>
    </feature>

    <feature spec="subsystem.elytron.http-authentication-factory">
        <param name="http-authentication-factory" value="wcc-ldap-http-authentication"/>
        <param name="http-server-mechanism-factory" value="global"/>
        <param name="security-domain" value="WccLdapSecurityDomain"/>
        <param name="mechanism-configurations" value="[{mechanism-name=BASIC,mechanism-realm-configurations=[{realm-name=&quot;exampleApplicationDomain&quot;}]}]"/>
    </feature>

    <feature spec="core-service.management.management-interface.http-interface">
        <param name="http-authentication-factory" value="wcc-ldap-http-authentication"/>
    </feature>

</feature-group-spec>
